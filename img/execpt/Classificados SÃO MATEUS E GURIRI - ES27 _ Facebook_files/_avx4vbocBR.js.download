;/*FB_PKG_DELIM*/

__d("MWXErrorBlock.react",["MWXButton.react","MWXColumn.react","MWXColumnItem.react","MWXImage.react","MWXTextPairing.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){var b=a.align;b=b===void 0?"center":b;var d=a.error,e=a.level;a=a.showImage;a=a===void 0?!0:a;var f=d.action,g=d.body,h=d.headline;d=d.image;return i.jsxs(c("MWXColumn.react"),{align:b,spacing:12,children:[a&&d!=null&&i.jsx(c("MWXColumnItem.react"),{children:i.jsx(c("MWXImage.react"),{src:d})}),i.jsx(c("MWXColumnItem.react"),{paddingTop:16,children:i.jsx(c("MWXTextPairing.react"),{body:g,bodyColor:"secondary",headline:h,level:e?e:2,textAlign:b})}),f!=null&&i.jsx(c("MWXColumnItem.react"),{align:"stretch",paddingVertical:16,children:i.jsx(c("MWXColumnItem.react"),{paddingVertical:16,children:i.jsx(c("MWXButton.react"),{label:f.label,onPress:f.onPress,padding:"wide",size:36})})})]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("ReStoreDBCorruption",[],(function(a,b,c,d,e,f){"use strict";var g="Got unexpected undefined",h="ReStoreDBCorruption";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b){var c,d=g+", table: "+b;c=a.call(this,d)||this;c.message=d;c.name=h;c.tableName=b;return c}return b}(babelHelpers.wrapNativeSuper(Error));f.ERROR_NAME=h;f.ReStoreDBCorruption=a}),66);
__d("getMWErrorDefinition",["fbt","ix","MAWUnrecoverableDbErrors","MWDeleteAllDBs","ReStoreDBCorruption","ReStoreDbVersionChange","ReStoreDecryptionFailure","ReStoreEARSetupFailure","cr:6883","gkx","isArmadillo"],(function(a,b,c,d,e,f,g,h,i){"use strict";function a(a,e){var f={action:{label:h._("__JHASH__DOoRvZWfN9Q__JHASH__"),onPress:function(){window.location.reload(!0)}},autoRefresh:"never",body:h._("__JHASH__iQVounN-Hch__JHASH__"),headline:h._("__JHASH__zDCPMqKBaum__JHASH__"),image:c("gkx")("23219")?e==="light"?i("210379"):i("210377"):i("433676")},g=a.messageFormat||"";if(!c("gkx")("24032")&&(a instanceof d("ReStoreDecryptionFailure").ReStoreDecryptionFailure||a instanceof d("ReStoreEARSetupFailure").ReStoreEARSetupFailure)){var j={label:f.action.label,onPress:function(){c("MWDeleteAllDBs")("error")["finally"](f.action.onPress)}};return c("isArmadillo")()?babelHelpers["extends"]({},f,{action:j,body:h._("__JHASH__ZtiWLX5ybEL__JHASH__"),headline:h._("__JHASH__ee6MA3uWv7t__JHASH__")}):babelHelpers["extends"]({},f,{action:j})}else if(a instanceof d("ReStoreDBCorruption").ReStoreDBCorruption||a.name===d("ReStoreDBCorruption").ERROR_NAME||g.includes(d("ReStoreDBCorruption").ERROR_NAME))return babelHelpers["extends"]({},f,{action:{label:f.action.label,onPress:b("cr:6883")!=null?function(){b("cr:6883").deleteIndexedDB("error")["finally"](f.action.onPress)}:f.action.onPress}});else if(a instanceof d("ReStoreDbVersionChange").ReStoreDbVersionChange||a.name===d("ReStoreDbVersionChange").ERROR_NAME||g.includes(d("ReStoreDbVersionChange").ERROR_NAME))return babelHelpers["extends"]({},f,{autoRefresh:"background",body:h._("__JHASH__GVy7XHUrKBw__JHASH__"),headline:h._("__JHASH__yndRKuZ7kSc__JHASH__"),image:c("gkx")("23219")?e==="light"?i("210437"):i("210435"):i("433676")});else if(a instanceof d("MAWUnrecoverableDbErrors").UnrecoverableDbError)return babelHelpers["extends"]({},f,{action:babelHelpers["extends"]({},f.action,{label:h._("__JHASH__LiLFo9P7Z2y__JHASH__")}),body:h._("__JHASH__2eqp-Oli5BK__JHASH__")});else return f}g["default"]=a}),226);
__d("MWErrorBlock.react",["FBLogger","LSPlatformLsInitLog","MWXErrorBlock.react","ReStoreDbVersionChange","getMWErrorDefinition","react","useCurrentDisplayMode"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;var j=b.useEffect,k=b.useMemo;function l(a){a instanceof d("ReStoreDbVersionChange").ReStoreDbVersionChange?c("FBLogger")("messenger_web_product").info(a.toString()):c("FBLogger")("messenger_web_product").catching(a).mustfix("Uncaught Error while loading chat: %s",a.toString())}function a(a){var b=a.canTriggerAutoReload,e=a.error;a=babelHelpers.objectWithoutPropertiesLoose(a,["canTriggerAutoReload","error"]);var f=c("useCurrentDisplayMode")(),g=k(function(){return c("getMWErrorDefinition")(e,f)},[e,f]),h=g.autoRefresh;g=babelHelpers.objectWithoutPropertiesLoose(g,["autoRefresh"]);j(function(){d("LSPlatformLsInitLog").addAnnotations({string:{uncaught_error:e.name}}),d("LSPlatformLsInitLog").fail("uncaught_error"),l(e)},[e]);j(function(){b===!0&&h==="background"&&document.visibilityState==="hidden"&&window.location.reload(!0)},[h,b,e]);return i.jsx(c("MWXErrorBlock.react"),babelHelpers["extends"]({},a,{error:g}))}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWInboxErrorState.react",["CometHeroFailTrigger.react","CometSection.react","MWErrorBlock.react","MWXColumn.react","MWXColumnItem.react","gkx","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react"),j={mdsRoot:{alignItems:"x6s0dn4",backgroundColor:"x2bj2ny",display:"x78zum5",height:"x1dr59a3",justifyContent:"xl56j7k",width:"xh8yej3",$$css:!0}};function a(a){var b=a.canTriggerAutoReload,d=a.error;a=a.xstyle;return i.jsx(c("MWXColumn.react"),{paddingHorizontal:16,verticalAlign:"center",xstyle:[c("gkx")("23219")&&j.mdsRoot,a],children:i.jsxs(c("MWXColumnItem.react"),{children:[i.jsx(c("CometHeroFailTrigger.react"),{description:"Inbox load failed",error:d,fail:!0}),i.jsx(c("CometSection.react"),{className:"xxc7z9f",role:"main",children:i.jsx(c("MWErrorBlock.react"),{canTriggerAutoReload:b,error:d})})]})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("CometMessagingChatTabErrorState.react",["MWInboxErrorState.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react"),j={cardWidth:{width:"x1cvmir6",$$css:!0},errorBoundary:{height:"x5yr21d",$$css:!0}};function a(a){a=a.error;return i.jsx(c("MWInboxErrorState.react"),{error:a,xstyle:[j.cardWidth,j.errorBoundary]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MAWInThreadBannerNuxReqCondWrapper.react",["CometPlaceholder.react","cr:9715","gkx","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(){return b("cr:9715")&&c("gkx")("1778")&&i.jsx(c("CometPlaceholder.react"),{fallback:null,children:i.jsx(b("cr:9715"),{hasNoMargin:!0})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWCMSubThreadChatTabWithSubthread.react",["BaseMultiStepContainer.react","CometPlaceholder.react","MWCMSubthreadChatTabContext.react","MWRelayChatTabHeaderRoot.react","MWV2ChatTabLoadingWithGlimmers.react","MWV2TabContainer","deferredLoadComponent","react","requireDeferredForDisplay"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react")),j=h.useCallback,k=c("deferredLoadComponent")(c("requireDeferredForDisplay")("MWCMSubthreadThreadViewChatTab.react").__setRef("MWCMSubThreadChatTabWithSubthread.react"));function l(a,b){return j(function(d){a(function(a){var e=a.onReturn;return i.jsx(c("CometPlaceholder.react"),{fallback:i.jsx(c("MWV2ChatTabLoadingWithGlimmers.react"),{tab:b}),children:i.jsx(k,{onReturn:function(){e()},tab:b,threadKey:d})})})},[a,b])}function m(a){var b=a.children,c=a.pushPage;a=a.tab;c=l(c,a);return i.jsx(d("MWCMSubthreadChatTabContext.react").MWCMSubthreadChatTabContextProvider,{pushSubthreadViewPage:c,children:b})}m.displayName=m.name+" [from "+f.id+"]";function a(a){var b=a.children,d=a.tab,e=a.thread,f=e.threadKey;return i.jsx("div",{className:"xgqcy7u x1lq5wgf x2c8kfy x17adc0v xhvchuf x1jx94hy x1rgmuzj xbbk1sx",children:i.jsx(c("BaseMultiStepContainer.react"),{disableFocusContainment:!1,disableInitialAutoFocus:!1,fallback:i.jsx(c("MWV2ChatTabLoadingWithGlimmers.react"),{tab:d}),fitContentWidth:!0,children:function(a){return i.jsx(m,{pushPage:a,tab:d,children:i.jsxs(c("MWV2TabContainer"),{style:{boxShadow:"none",margin:0},tab:d,threadKey:e.threadKey,children:[i.jsx(c("MWRelayChatTabHeaderRoot.react"),{pushPage:a,tab:d,threadKey:f}),b]})})}})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWChatTabInThreadBanner.react",["CometErrorBoundary.react","CometPlaceholder.react","LSMessagingThreadTypeUtil","MWLSInThreadBannerComponent.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){a=a.thread;if(d("LSMessagingThreadTypeUtil").isArmadilloSecure(a.threadType)||d("LSMessagingThreadTypeUtil").isJoinedSocialChannel(a.threadType))return null;else return i.jsx(c("CometPlaceholder.react"),{fallback:null,children:i.jsx(c("CometErrorBoundary.react"),{fallback:function(){return null},children:i.jsx(c("MWLSInThreadBannerComponent.react"),{threadKey:a.threadKey})})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWInChatTabContextProvider.react",["react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));c=h;e=c.createContext;var j=c.useContext,k=e(!1);function a(){return j(k)}function b(a){a=a.children;return i.jsx(k.Provider,{value:!0,children:a})}b.displayName=b.name+" [from "+f.id+"]";g.useInChatTab=a;g.InChatTabContextProvider=b}),98);
__d("useMWFetchMessageByPinnedMessageId",["FBLogger","I64","LSFactory","LSMessagePointQueryStoredProcedure","LSMessagingThreadTypeUtil","MAWThreadCutover","ReQL","ReQLSuspense","asyncToGeneratorRuntime","promiseDone","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(a,b,c){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){var g;g=(i||(i=d("I64"))).to_int32((g=b.syncGroup)!=null?g:(i||(i=d("I64"))).neg_one);if(g!==-1&&g===95){c("FBLogger")("messenger_web_messaging").mustfix("useMWFetchMessageByPinnedMessageId: incorrect call to MPQ with secure mailbox");return}yield a.runInTransaction(function(a){return c("LSMessagePointQueryStoredProcedure")(c("LSFactory")(a),{messageId:e,threadKey:b.threadKey,threadType:b.threadType})},"readwrite",void 0,void 0,f.id+":53")});return k.apply(this,arguments)}function a(a){var b=(h||(h=c("useReStore")))(),e=d("ReQLSuspense").useFirst(function(){return d("ReQL").fromTableAscending(b.tables.threads,["threadType"]).getKeyRange(a)},[b,a],f.id+":66"),g=d("MAWThreadCutover").useGetCutoverOpenThreadKey(a),i=g!=null,k=g||a;g=d("MAWThreadCutover").useIsDualThreadCutoverOpenThread(g);e=e!=null&&d("LSMessagingThreadTypeUtil").isArmadilloSecure(e.threadType);var l=e&&(!i||g),m=d("ReQLSuspense").useFirst(function(){return d("ReQL").fromTableDescending(b.tables.threads,["threadKey","threadType","syncGroup"]).getKeyRange(k)},[b,k],f.id+":86");e=d("ReQLSuspense").useArray(function(){return l?d("ReQL").empty():d("ReQL").fromTableDescending(b.tables.msg_pinned_messages_v2.index("pinnedMessageDisplayOrder")).getKeyRange(k).map(function(a){a=a.messageId;var e=d("ReQLSuspense").first(d("ReQL").fromTableDescending(b.tables.messages.index("messageId")).getKeyRange(a),f.id+":105");m!=null&&e==null&&c("promiseDone")(j(b,m,a));return{message:e,pinnedMessageId:a}})},[b,k,l,m],f.id+":96");return e.map(function(a){return a.message})}g["default"]=a}),98);
__d("useMWJumpToMessageWrapper",["useMWJumpToMessage"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return c("useMWJumpToMessage")(a.source)}g["default"]=a}),98);
__d("MWInboxPinnedMessagesBanner.react",["fbt","BaseMiddot.react","CometErrorBoundary.react","FBLogger","I64","JSResourceForInteraction","LSIntEnum","LSMessagingThreadTypeUtil","MWBroadcastChannelLoggingShapes","MWLSThreadDisplayContext","MWLogBroadcastChannelFalcoEvent","MWPActor.react","MWUnvaultedText","MWXColumn.react","MWXColumnItem.react","MWXIconChevronDown","MWXIconForListCell.react","MWXIconPushpin","MWXIconStrict.react","MWXPressable.react","MWXRow.react","MWXRowItem.react","MWXText.react","ReQL","ReQLSuspense","cr:7535","isMWBumpMessage","react","useMWFetchMessageByPinnedMessageId","useMWJumpToMessageWrapper","useMWXLazyDialog","useReStore","useStringWithSubstitutions"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k,l,m=j||(j=d("react")),n=j.useMemo;function a(a){return[]}var o=(b=b("cr:7535"))!=null?b:a,p={pinnedMessagesWrapper:{alignItems:"x6s0dn4",display:"x78zum5",$$css:!0},pinnedMessagesWrapperChatTabs:{borderBottomColor:"x80vd3b",borderBottomStyle:"x1q0q8m5",borderBottomWidth:"xso031l",$$css:!0},pinnedMessagesWrapperInbox:{borderTopColor:"x1pdss0j",borderTopStyle:"x13fuv20",borderTopWidth:"x178xt8z",$$css:!0},row:{height:"x10wjd1d",marginTop:"xdj266r",marginEnd:"x11i5rnm",marginBottom:"xat24cr",marginStart:"x1mh8g0r",$$css:!0},rowText:{height:"xlup9mm",$$css:!0}},q=c("JSResourceForInteraction")("MWPinnedMessagesDialog.react").__setRef("MWInboxPinnedMessagesBanner.react");function r(a,b,e){var f=a==null?void 0:a.text,g=b&&a!=null?(k||(k=d("I64"))).equal(e,a.threadKey):!1;b=n(function(){var b;return new Set(g?(b=a==null?void 0:(b=a.mentionIds)==null?void 0:b.split==null?void 0:b.split(","))!=null?b:[]:[])},[g,a==null?void 0:a.mentionIds]);f=d("MWUnvaultedText").getMWUnvaultedText(g,f);b=(b=(b=d("useStringWithSubstitutions").useStringWithMentionSubstitutionsAndUpdatedRanges(f,[],b))==null?void 0:b.textWithSubstitutions)!=null?b:f;e=(e=d("useStringWithSubstitutions").useStringWithSubstitutions(f,e))!=null?e:f;f=c("isMWBumpMessage")(a);return f?e:b}function s(a){if(a==null)return"";if((k||(k=d("I64"))).equal(a.displayedContentTypes,(l||(l=d("LSIntEnum"))).ofNumber(2)))return h._("__JHASH__xgjHlv2kQPY__JHASH__");else if((k||(k=d("I64"))).equal(a.displayedContentTypes,(l||(l=d("LSIntEnum"))).ofNumber(4)))return h._("__JHASH__X9DncealQbJ__JHASH__");else if((k||(k=d("I64"))).equal(a.displayedContentTypes,(l||(l=d("LSIntEnum"))).ofNumber(4096))||(k||(k=d("I64"))).equal(a.displayedContentTypes,(l||(l=d("LSIntEnum"))).ofNumber(134217728)))return h._("__JHASH__rZqTMZ7dJmB__JHASH__");else if((k||(k=d("I64"))).equal(a.displayedContentTypes,(l||(l=d("LSIntEnum"))).ofNumber(16384)))return h._("__JHASH__qqvxkP_nlPB__JHASH__");else if((k||(k=d("I64"))).equal(a.displayedContentTypes,(l||(l=d("LSIntEnum"))).ofNumber(64)))return h._("__JHASH__BbHS9IlclMk__JHASH__");return h._("__JHASH__KsTQ68TZNpQ__JHASH__")}function t(a){c("FBLogger")("messenger_web_pinned_messages").catching(a).mustfix("uncaught exception in MWInboxPinnedMessagesBanner.react. Error:%s",a.message)}function e(a){a=a.thread;return m.jsx(c("CometErrorBoundary.react"),{fallback:function(){return null},onError:t,children:m.jsx(u,{thread:a})})}e.displayName=e.name+" [from "+f.id+"]";function u(a){var b=a.thread;a=c("useMWXLazyDialog")(q);var e=a[0],g=(i||(i=c("useReStore")))();a=c("useMWFetchMessageByPinnedMessageId")(b.threadKey);var j=o(b.threadKey);j=j.concat(a);a=[];var l=j.reduce(function(a,b){return b!=null?[].concat(a,[b]):a},a);j=d("MWPActor.react").useActor();var t=c("useMWJumpToMessageWrapper")({source:"Pinned"}),u=(l==null?void 0:l.length)>0?l[0]:null;a=d("ReQLSuspense").useFirst(function(){return(u==null?void 0:u.senderId)!=null?d("ReQL").fromTableAscending(g.tables.contacts).getKeyRange(u.senderId):d("ReQL").empty()},[u==null?void 0:u.senderId,g],f.id+":245");var v=d("LSMessagingThreadTypeUtil").isArmadilloSecure(b.threadType),w=r(u,v,b.threadKey);v=n(function(){return w!=null&&w!==""?w:s(u)},[u,w]);var x=d("MWLSThreadDisplayContext").useMWLSThreadDisplayContext()==="Inbox";if(l.length===0)return null;var y={eventName:"open_view_pinned_messages_dialog",threadKey:b.threadKey,threadType:b.threadType},z=d("LSMessagingThreadTypeUtil").isDiscoverablePublicBroadcastChannel(b.threadType);a=(u==null?void 0:u.senderId)!=null&&(k||(k=d("I64"))).equal(j,u.senderId)?"You":(j=a==null?void 0:a.name)!=null?j:"";return m.jsx(c("MWXPressable.react"),{"aria-label":z?h._("__JHASH__uKLUxuQU_CD__JHASH__",[h._param("lastPinnedMessage",v)]):h._("__JHASH__YIRbXxGdt3C__JHASH__",[h._param("lastPinnedMessage",v)]),display:"inline",expanding:!0,loggingEvent:y,onPress:function(){if(l.length===1){var a=l[0];a!=null&&a.messageId!=null&&a.timestampMs!=null&&t(a.messageId,a.timestampMs)}else e({threadKey:b.threadKey});z&&d("MWLogBroadcastChannelFalcoEvent").logBroadcastChannelFalcoEvent(babelHelpers["extends"]({},d("MWBroadcastChannelLoggingShapes").VIEW_PINNED_MESSAGES_FROM_THREAD_VIEW_BANNER,{clientExtras:{isDialogOpened:(l.length>1).toString()},threadFbid:b.threadKey}))},overlayDisabled:!0,overlayFocusRingPosition:"inset",testid:void 0,xstyle:[p.pinnedMessagesWrapper,x?p.pinnedMessagesWrapperInbox:p.pinnedMessagesWrapperChatTabs],children:m.jsxs(c("MWXRow.react"),{expanding:!0,paddingHorizontal:8,paddingVertical:0,verticalAlign:"center",xstyle:p.row,children:[m.jsx(c("MWXRowItem.react"),{verticalAlign:"center",children:m.jsx(c("MWXIconForListCell.react"),{color:"secondary",icon:c("MWXIconPushpin"),size:"medium"})}),m.jsx(c("MWXRowItem.react"),{expanding:!0,verticalAlign:"center",children:m.jsxs(c("MWXColumn.react"),{children:[m.jsx(c("MWXColumnItem.react"),{verticalAlign:"center",xstyle:p.rowText,children:m.jsx(c("MWXText.react"),{color:"secondary",numberOfLines:1,type:"meta3",children:z?h._("__JHASH__Dezv4EV21yi__JHASH__",[h._param("channel_creator_name",a),h._param("middot",m.jsx(c("BaseMiddot.react"),{}))]):h._("__JHASH__5htmo3zfvNj__JHASH__",[h._param("message_sender_name",a)])})}),m.jsx(c("MWXColumnItem.react"),{verticalAlign:"center",xstyle:p.rowText,children:m.jsx(c("MWXText.react"),{numberOfLines:1,type:"bodyLink4",children:v})})]})}),l.length>1&&m.jsx(c("MWXRowItem.react"),{children:m.jsx(c("MWXIconStrict.react"),{color:"secondary",icon:c("MWXIconChevronDown"),size:16})})]})})}u.displayName=u.name+" [from "+f.id+"]";g["default"]=e}),226);
__d("MWV2ChatTabThreadLinkHashContext.react",["react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));c=h;e=c.createContext;var j=c.useContext,k=e(null);function a(a){var b=a.children;a=a.threadLinkHash;return i.jsx(k.Provider,{value:(a=a)!=null?a:null,children:b})}a.displayName=a.name+" [from "+f.id+"]";function b(){return j(k)}g.MWV2ChatTabThreadLinkHashContextProvider=a;g.useGetChatTabThreadLinkHash=b}),98);
__d("useMWChatStateUpdateThreadKeyDescriptorIfAuthoritative",["Int64Hooks","LSAuthorityLevel","LSIntEnum","MWChatStateActions","MWChatStateV2.react"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b,e){e===void 0&&(e={shouldClearOldHiddenTab:!1,shouldUpdateThreadType:!1});var f=d("MWChatStateV2.react").useDispatch(),g=a==null?void 0:a.threadKey,i=a==null?void 0:a.clientThreadKey,j=a==null?void 0:a.threadType,k=a==null?void 0:a.authorityLevel;d("Int64Hooks").useEffectInt64(function(){g!=null&&k!=null&&(h||(h=d("LSIntEnum"))).toNumber(k)>=c("LSAuthorityLevel").AUTHORITATIVE&&f(d("MWChatStateActions").updateThreadKeyDescriptor(b.tabId,g,i,e.shouldUpdateThreadType?j:void 0,{shouldClearOldHiddenTab:e.shouldClearOldHiddenTab}))},[b.tabId,g,i,f,k,j,e.shouldUpdateThreadType,e.shouldClearOldHiddenTab])}g["default"]=a}),98);
__d("useMWCloseDuplicateChatTabs",["I64","MWChatStateActions","MWChatStateContext","MWChatStateV2.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=(h||d("react")).useEffect;function a(a){var b=d("MWChatStateContext").useChatState(function(a){return a.tabs}),c=d("MWChatStateV2.react").useDispatch();j(function(){var e;if(((e=a.tabType.threadKeyDescriptor)==null?void 0:e.threadKey)==null)return;e=Array.from(b.values()).filter(function(b){var c,e=b.tabId;b=b.tabType;return((c=b.threadKeyDescriptor)==null?void 0:c.threadKey)==null||((c=a.tabType.threadKeyDescriptor)==null?void 0:c.threadKey)==null?!1:a.tabId>e&&(i||(i=d("I64"))).equal(b.threadKeyDescriptor.threadKey,a.tabType.threadKeyDescriptor.threadKey)});e.forEach(function(a){var b=a.closeWatermark,e=a.openWatermark;a=a.tabId;e>b&&c(d("MWChatStateActions").closeTab(Date.now(),a))})},[c,a,b])}g["default"]=a}),98);
__d("MWV2ChatTab.react",["CometErrorBoundary.react","CometMessagingChatTabErrorState.react","CometPageletWithDiv.react","CometTransientDialogProvider.react","I64","Int64Hooks","InteractionTracingMetrics","LSFactory","LSMessagingThreadTypeUtil","LSPlatformWaitForTaskCompletion","LSThreadBitOffset","LSThreadPointQueryAndRestoreMessagesWithJIDStoredProcedure","LegacyHidden","MAWInThreadBannerNuxReqCondWrapper.react","MAWThreadCutover","MAWUnrecoverableErrorBoundary.react","MWChatConnectionStatusCard.react","MWChatInteraction","MWChatStateContext","MWChatTabInThreadBanner.react","MWInChatTabContextProvider.react","MWInboxPinnedMessagesBanner.react","MWOpenAndSecureThreadView.react","MWPNewMessageAnnouncementForScreenReaders.react","MWPThreadIsPage.react","MWPThreadThemeProvider.react","MWPVisibleMessageContext.react","MWRelayChatTabHeaderRoot.react","MWThreadKey.react","MWV2ChatTabHeaderLoadingWithGlimmers.react","MWV2ChatTabLoadingWithGlimmers.react","MWV2ChatTabThreadLinkHashContext.react","MWV2ComposerActionsContext.react","MWV2ComposerHasContentContext.react","MWV2EnsureThatChatTabExists","MWV2ErrorComposer.react","MWV2FileDropzone.react","MWV2TabContainer","MWXRelayComposer.react","MetaConfig","ReQL","ReQLSuspense","XPlatWebAudioPlaybackContextProvider.react","cr:1113","cr:5001","cr:6111","cr:8060","cr:8061","emptyFunction","gkx","promiseDone","qex","react","stylex","useC4gEngagementImpressionLogging","useEmptyFunction","useMAWTriggerOnDemandCutover","useMWChatStateUpdateThreadKeyDescriptorIfAuthoritative","useMWCloseDuplicateChatTabs","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l=j||(j=d("react")),m=j,n=m.memo,o=m.useCallback,p=m.useLayoutEffect,q=m.useMemo,r=m.useRef;function a(a,b){return[!1,!0,null]}var s=(m=b("cr:8061"))!=null?m:a,t=(m=b("cr:1113"))!=null?m:c("useEmptyFunction");function u(a){var b=a.children;a=a.themeFbid;return c("gkx")("24125")?l.jsx(c("CometTransientDialogProvider.react"),{children:l.jsx(c("MWPThreadThemeProvider.react"),{themeFbid:a,children:b})}):l.jsx(c("MWPThreadThemeProvider.react"),{themeFbid:a,children:l.jsx(c("CometTransientDialogProvider.react"),{children:b})})}u.displayName=u.name+" [from "+f.id+"]";function v(a){var e=a.isMinimized,f=a.otherContactIdForDefaultE2eeThread,g=a.shouldUseDefaultE2eeOneToOne,h=a.tab,i=a.thread;a=a.threadLinkHash;var j=i.themeFbid,k=i.threadKey,m=i.threadSubtype,n=i.threadType;t({groupThreadSubtype:m,threadKey:k,threadType:n});c("useC4gEngagementImpressionLogging")({threadKey:k,threadType:n});m=d("LSMessagingThreadTypeUtil").isDiscoverablePublicBroadcastChannel(n);var s=d("LSThreadBitOffset").has(167,i),v=!d("LSThreadBitOffset").has(56,i);n=d("LSMessagingThreadTypeUtil").isArmadilloSecure(n);var w=r({getScrollAreaElement:c("emptyFunction"),jumpToMostRecentMessage:c("emptyFunction"),restoreScrollPosition:c("emptyFunction")}),x=d("MWChatStateContext").useChatState(function(a){return a.focusedTabId});c("useMWCloseDuplicateChatTabs")(h);p(function(){if(x!==h.tabId){var a;(a=w.current)==null?void 0:a.restoreScrollPosition()}},[x,h.tabId]);var y=d("LSMessagingThreadTypeUtil").isOpenOrArmadilloFnFThread(i);m=d("LSThreadBitOffset").has(106,i)&&(m&&c("MetaConfig")._("105")||y&&c("qex")._("760")===!0);var z=c("gkx")("4889"),A=o(function(){var a;(a=w.current)==null?void 0:a.jumpToMostRecentMessage()},[]);y=q(function(){return z===!0?c("emptyFunction"):A},[z,A]);var B=q(function(){return z===!0?A:c("emptyFunction")},[z,A]);n=l.jsxs(l.Fragment,{children:[h.tabId!==x?null:l.jsx(c("MWPNewMessageAnnouncementForScreenReaders.react"),{thread:i}),n?l.jsx(c("MAWInThreadBannerNuxReqCondWrapper.react"),{}):null,l.jsx(c("MWChatConnectionStatusCard.react"),{}),l.jsx(c("MWChatTabInThreadBanner.react"),{thread:i}),m&&l.jsx(c("MWInboxPinnedMessagesBanner.react"),{thread:i}),l.jsxs(d("MWV2FileDropzone.react").MWV2FileDropzone,{isMediaOnly:v,thread:i,children:[l.jsx(c("MWOpenAndSecureThreadView.react"),{entryPoint:"popup_chat_box",isMinimizedChatTab:e,messageListRef:w,thread:i}),l.jsx(c("MAWUnrecoverableErrorBoundary.react"),{fallback:function(a){return l.jsx(c("CometMessagingChatTabErrorState.react"),{error:a})},children:l.jsx(c("CometErrorBoundary.react"),{fallback:function(){return l.jsx(c("MWV2ErrorComposer.react"),{})},children:l.jsx(d("MWV2ChatTabThreadLinkHashContext.react").MWV2ChatTabThreadLinkHashContextProvider,{threadLinkHash:a,children:l.jsx(d("MWV2ComposerActionsContext.react").MWV2ComposerActionsListener,{onMessageSendAttempt:B,children:l.jsx(d("CometPageletWithDiv.react").Placeholder,{fallback:null,name:"MWComposer",children:l.jsx(c("MWXRelayComposer.react"),{afterSendMessage:y,isPreviewThread:!1,threadKey:k})})})})})})]})]});m=b("cr:6111")!=null&&s?l.jsx(b("cr:6111"),{tab:h,thread:i,children:n}):null;v=function(a){return g?l.jsx(l.Fragment,{children:a}):l.jsx(d("MWThreadKey.react").MWThreadKeyProvider,{id:k,children:a})};e=b("cr:5001")==null?void 0:b("cr:5001").MWAdmodOnboardingSuggestedActionsContextProvider;a=m!=null?m:g&&b("cr:8060")!=null?l.jsx(b("cr:8060"),{otherContactIdForDefaultE2eeThread:f,tab:h}):l.jsxs(c("MWV2TabContainer"),{tab:h,threadKey:k,children:[l.jsx(d("CometPageletWithDiv.react").Placeholder,{fallback:l.jsx(c("MWV2ChatTabHeaderLoadingWithGlimmers.react"),{tab:h}),name:"MWChatTabHeader",children:l.jsx(c("MWRelayChatTabHeaderRoot.react"),{tab:h,threadKey:k})}),n]});return l.jsx(d("MWPThreadIsPage.react").Provider,{threadKey:k,children:v(l.jsx(c("XPlatWebAudioPlaybackContextProvider.react"),{children:l.jsx(d("MWPVisibleMessageContext.react").MWPVisibleMessageContextProvider,{children:l.jsx(u,{themeFbid:j,children:l.jsx(d("MWV2ComposerHasContentContext.react").MWV2ComposerHasContentContextProvider,{children:l.jsx(d("MWInChatTabContextProvider.react").InChatTabContextProvider,{children:e!=null?l.jsx(e,{children:a}):a})})})})}))})}v.displayName=v.name+" [from "+f.id+"]";function w(a,b){var e=d("MAWThreadCutover").useIsDualThreadCutoverOpenThread(a),g=(d("MAWThreadCutover").useIsCutoverOpenThread(a)||b!=null&&d("LSThreadBitOffset").has(128,b))&&!e&&c("gkx")("24126");b=d("MAWThreadCutover").useGetCutoverSecureThreadKey((k||(k=d("I64"))).to_string(a));var i=c("gkx")("24126")?b:null,j=(h||(h=c("useReStore")))();d("Int64Hooks").useEffectInt64(function(){if(!g)return;if(i==null)c("promiseDone")(c("LSPlatformWaitForTaskCompletion")(j,function(b){return c("LSThreadPointQueryAndRestoreMessagesWithJIDStoredProcedure")(c("LSFactory")(b),{waJid:a})},"readwrite"));else{var b=d("MWChatInteraction").get((k||(k=d("I64"))).to_string(a));if(b!=null){var e;d("MWChatInteraction").set(i,b);(e=c("InteractionTracingMetrics")).addMetadata(b,"thread_id",i);e.addMetadata(b,"thread_type",15..toString());e.addMetadata(b,"is_secure",!0);e.addMetadata(b,"redirectedFromPreCutover",1)}}},[i,j,g,a]);b=d("ReQLSuspense").useFirst(function(){return i!=null?d("ReQL").fromTableAscending(j.tables.threads).getKeyRange((k||(k=d("I64"))).of_string(i)):d("ReQL").empty()},[j,i],f.id+":407");e=e?void 0:b;return e}var x={hidden:{display:"x1s85apg",$$css:!0}};function e(a){var b,e=a.isMinimized;e=e===void 0?!1:e;var g=a.tab;a=a.threadKeyDescriptor;var j=(h||(h=c("useReStore")))(),k=a.threadKey,m=a.clientThreadKey,n=a.threadLinkHash;d("MWV2EnsureThatChatTabExists").useMWV2EnsureThatChatTabExists(k,a.threadType,m);var o=d("ReQLSuspense").useFirst(function(){return d("ReQL").fromTableAscending(j.tables.threads,["folderName","themeFbid","threadKey","threadType","parentThreadKey","threadSubtype","threadName","authorityLevel","cannotUnsendReason","threadStatus","cannotReplyReason","clientThreadKey","consistentThreadFbid"].concat(d("LSThreadBitOffset").threadCapabilityFields)).getKeyRange(k)},[j,k],f.id+":446"),p=d("ReQLSuspense").useFirst(function(){return m!=null?d("ReQL").fromTableAscending(j.tables.threads.index("clientThreadKey")).getKeyRange(m):d("ReQL").empty()},[j,m],f.id+":465"),q=w(k,o);o=(q=(q=q)!=null?q:o)!=null?q:p;c("useMWChatStateUpdateThreadKeyDescriptorIfAuthoritative")(o,g,{shouldClearOldHiddenTab:!0,shouldUpdateThreadType:!0});p=s((q=o==null?void 0:o.threadKey)!=null?q:k,o==null?void 0:o.threadType);q=p[0];var r=p[1];p=p[2];b=(b=c("useMAWTriggerOnDemandCutover")({threadKey:(b=o==null?void 0:o.threadKey)!=null?b:k,triggerSource:"chatTab"}))!=null?b:!1;a=c("gkx")("5578")&&d("MWV2EnsureThatChatTabExists").isOptimisticSecureThread(k,a.threadType,m);if(o!=null&&d("LSMessagingThreadTypeUtil").isOpenOneToOne(o.threadType)&&!r||b||a)return e?null:l.jsx(c("MWV2ChatTabLoadingWithGlimmers.react"),{tab:g});return o!=null?c("gkx")("3795")?l.jsx(c("LegacyHidden"),{"data-testid":void 0,mode:e?"hidden":"visible",children:l.jsx(v,{isMinimized:e,otherContactIdForDefaultE2eeThread:p,shouldUseDefaultE2eeOneToOne:o!=null&&d("LSMessagingThreadTypeUtil").isOpenOneToOne(o.threadType)&&q,tab:g,thread:o,threadLinkHash:n})}):l.jsx("div",{className:(i||(i=c("stylex")))(e?x.hidden:void 0),"data-testid":void 0,children:l.jsx(v,{isMinimized:e,otherContactIdForDefaultE2eeThread:p,shouldUseDefaultE2eeOneToOne:o!=null&&d("LSMessagingThreadTypeUtil").isOpenOneToOne(o.threadType)&&q,tab:g,thread:o,threadLinkHash:n})}):null}e.displayName=e.name+" [from "+f.id+"]";a=n(e);g["default"]=a}),98);